<html>
  <head>
    <title>Deutsch-Deklination-Explorer</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript">
    var suffixe = {
      nominativ : {
          masculinen : '',
          neutral    : '',
          femininum  : 'e',
          plural     : 'e'
      },
      akkusativ : {
          masculinen : 'en',
          neutral    : '',
          femininum  : 'e',
          plural     : 'e'
      },
      dativ     : {
          masculinen : 'em',
          neutral    : 'em',
          femininum  : 'er',
          plural     : 'en'
      },
      genitiv   : {
          masculinen : 'es',
          neutral    : 'es',
          femininum  : 'er',
          plural     : 'er'
      }
    };
    var bestimmt_suffixe = {
      nominativ : {
        masculinen : 'er',
        neutral    : 'es'
      },
      akkusativ : {
        neutral    : 'es'
      }
    };
    var ausnahmen = {
      d : {
        nominativ : {
          neutral   : 'das',
          femininum : 'die',
          plural    : 'die'
        },
        akkusativ : {
          neutral   : 'das',
          femininum : 'die',
          plural    : 'die'
        }
      },
      eur : {
        nominativ : {
          masculinen : 'euer',
          neutral    : 'euer'
        },
        akkusativ : {
          neutral    : 'euer'
        }
      }
    };
    // We use 'kase' because 'case' is a keyword in JavaScript
    function find_suffix(group, stem, kase, gender) {
      if (group == 'bestimmt' && bestimmt_suffixe[kase] && bestimmt_suffixe[kase][gender]) {
        return bestimmt_suffixe[kase][gender];
      } else {
        return suffixe[kase][gender];
      }
    }
    function decline(group, stem, kase, gender, suffix) {
      if (stem == 'ein' && gender == 'plural') {
        return '';
      } else if (ausnahmen[stem] && ausnahmen[stem][kase] && ausnahmen[stem][kase][gender]) {
        return ausnahmen[stem][kase][gender];
      } else {
        return (stem ? stem : (suffix ? '-' : '')) + suffix;
      }
    }
    function render() {
      var stem = $('#stem').val();
      var group = $('#stem option:selected').parent('optgroup').attr('label');
      document.location.hash = stem;
      for (var kase in suffixe) {
        for (var gender in suffixe[kase]) {
          var suffix = find_suffix(group, stem, kase, gender);
          var form = decline(group, stem, kase, gender, suffix);
          if (! form.length) {
            suffix = '';
          } else if (form.slice(-2) == 'as') {
            suffix = 'as';
          }
          $('tr.' + kase + ' > td.' + gender).text(form).removeClass('e er en em es as').addClass(suffix);
        }
      }
    };
    $(document).ready(function () {
      $('#stem').change(render);
      var selected = document.location.hash.replace('#', '');
      if (selected) {
        $('#stem').val(selected);
      } else {
        $($('#stem option')[0]).attr('selected', true);
      }
      $('#stem').change();
    });
    </script>
    <style>
      body {
        width:500px;
        margin: 0 auto;
        text-align: center;
      }
      table {
        width: 500px;
        border-collapse: collapse;
      }
      td, th {
        width: 20%;
        padding: 0.125em;
      }
      th {
        text-align: left;
      }
      th:first-child {
        text-align: right;
      }
      td {
      }
      td.es { background-color: #fdfdb4; } /* yellow */
      td.en { background-color: #a9eea9; } /* green  */
      td.er { background-color: #a9c6ee; } /* blue   */
      td.em { background-color: #d7a9ee; } /* purple */
      td.e  { background-color: #fdb4b4; } /* red    */
      td.as { background-color: #fde0b4; } /* orange */
    </style>
  </head>
  <body>
    <h1>Deutsch-Deklination-Explorer</h1>
    <form>
      <label for="stem">stamm:</label>
      <select id="stem">
        <optgroup label="unbestimmt">
          <option value=""></option>
          <option value="ein"  >ein-</option>
          <option value="kein" >kein-</option>
          <option value="mein" >mein-</option>
          <option value="dein" >dein-</option>
          <option value="sein" >sein-</option>
          <option value="ihr"  >ihr-</option>
          <option value="unser">unser-</option>
          <option value="eur"  >eur-</option>
        </optgroup>
        <optgroup label="bestimmt">
          <option value=""></option>
          <option value="d"          >der/die/das</option>
          <option value="dies"       >dies-</option>
          <option value="jen"        >jen-</option>
          <option value="welch"      >welch-</option>
        </optgroup>
      </select>
    </form>
    <table>
      <tbody>
        <tr>
          <th></th>
          <th>masculinen</th>
          <th>neutral</th>
          <th>femininum</th>
          <th>plural</th>
        </tr>
        <tr class="nominativ">
          <th>nominativ</th>
          <td class="masculinen"></td>
          <td class="neutral"   ></td>
          <td class="femininum" ></td>
          <td class="plural"    ></td>
        </tr>
        <tr class="akkusativ">
          <th>akkusativ</th>
          <td class="masculinen"></td>
          <td class="neutral"   ></td>
          <td class="femininum" ></td>
          <td class="plural"    ></td>
        </tr>
        <tr class="dativ">
          <th>dativ</th>
          <td class="masculinen"></td>
          <td class="neutral"   ></td>
          <td class="femininum" ></td>
          <td class="plural"    ></td>
        </tr>
        <tr class="genitiv">
          <th>genitiv</th>
          <td class="masculinen"></td>
          <td class="neutral"   ></td>
          <td class="femininum" ></td>
          <td class="plural"    ></td>
        </tr>
      </tbody>
    </table>
  </body>
</html>